version: "3.9"
services:
  xtts:
    build:
      context: ..
      dockerfile: containers/Dockerfile
    env_file:
      - ../.env
      - ../.env.local
    volumes:
      - ../artifacts:/app/artifacts
      - ../app:/app/app
    command: []
    healthcheck:
      # Honor TTS_OUTPUT_DIR if set; fall back to demo path
      test: ["CMD-SHELL", "test -f \"${TTS_OUTPUT_DIR:-/app/artifacts/outputs/demo}/render.wav\""]
      interval: 60s
      timeout: 10s
      retries: 3
      start_period: 30s
